import{q as S,r as f,c as M,o as B,g,b as a,d as l,e as s,h as r,n as k,t as u,F as v,k as _,f as D,j as R,i as b,z as O}from"../../../chunk/toDom-Dqu9wsvS.js";import{f as q,g as E,h as X,i as N,j as $}from"../../../chunk/upload-Bns8lZv9.js";function W(m){const y=m.lastIndexOf("\\"),c=m.lastIndexOf("/"),d=Math.max(y,c);return m.substring(d+1)}const z={class:"file-list"},L={class:"upload-manager"},H={class:"result-icon"},V={key:0,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},A={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},K={class:"result-content"},J={key:0,class:"job-info"},Q={class:"mt-6"},G=["onClick"],U={class:"font-medium text-blue-700"},Y={class:"text-xs text-gray-500"},P={class:"pl-4 border-l-2 border-gray-100 ml-6"},ee={class:"flex-shrink-0 w-5"},te={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},se={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},oe=["onClick"],ne=["onClick"],ae=["onClick"],le={key:0,class:"text-center py-8 text-gray-500"},ie=S({__name:"FileBrowser",setup(m){const c=f([["documents/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["images/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["reports/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["uploads/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["backups/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["README.md","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["config.json","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["manifest.bin","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/contract_v2.pdf.enc","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/invoice_2025Q3.pdf.enc","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/specs/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/specs/api_v1.yaml","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/specs/db_schema.sql","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/drafts/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/drafts/meeting_notes.txt","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["documents/drafts/proposal_v0.enc","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["images/logo.png","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["images/banner.jpg","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["images/icons/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["images/icons/favicon.ico","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["images/icons/social/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["images/icons/social/twitter.svg","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["images/icons/social/telegram.png","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["reports/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["reports/monthly/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["reports/monthly/january_2025.pdf","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["reports/monthly/february_2025.pdf.enc","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["reports/summary_2024.xlsx","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["reports/audit_log.bin.sig","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["uploads/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["uploads/user_123/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["uploads/user_123/file_a.bin.enc","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["uploads/user_123/metadata.json","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["uploads/user_456/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["uploads/user_456/report_final.pdf.enc","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["uploads/temp_upload_session_7a3b.bin","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["backups/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["backups/db_20251210.sql.gz","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["backups/keys/","directory","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["backups/keys/x25519_pubkey.bin","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["backups/keys/chacha20_key.enc","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"],["backups/keys/file_id_16b.bin","file","abcdefghijklmn","0","2025-12-12T04:27:13.000000Z"]]),d=f(null),p=f(new Set(["/"])),j=t=>t.endsWith("/")?t.slice(0,-1):t.substring(0,t.lastIndexOf("/")+1)||"/",T=M(()=>{const t={};for(const e of c.value){const o=j(e[0]);t[o]||(t[o]=[]),t[o].push(e)}return t}),w=t=>{p.value.has(t)?p.value.delete(t):p.value.add(t)},x=t=>p.value.has(t),Z=t=>{const e=E(t[2]),o=document.createElement("a");o.href=e,o.setAttribute("download",W(t[0])),document.body.appendChild(o),o.click(),document.body.removeChild(o),d.value={type:"completed",title:"File Downloaded",message:`${t[0]} is downloaded.`,jobId:"0"}},C=async t=>{const e=c.value.indexOf(t);if(e>-1){const o=X(t[2],t[3]);await fetch(o,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":g(),"Content-Type":"application/json"}}).then(i=>i.json()),c.value.splice(e,1),d.value={type:"completed",title:"File Deleted",message:`${t[0]} is deleted.`,jobId:"0"}}},F=async t=>{const e=t[3],o=N(e);await fetch(o,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":g(),"Content-Type":"application/json"}}),d.value={type:"processing",title:"File is being imported to workspace",message:`${t[0]} is processed.`,jobId:"0"},await I(t)},I=async t=>{const e=t[3],o=setInterval(async()=>{const i=await fetch($(e)).then(n=>n.json());(i.status==="completed"||i.failed)&&(clearInterval(o),d.value={type:i.status,title:"Make Worksapce",message:`Make workspace from uploaded ${t[0]} is done.`,jobId:i.job_id})},2e3)};return B(async()=>{const t=await fetch(q(),{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":g(),"Content-Type":"application/json"}}).then(e=>e.json());c.value=t.list.map(e=>{const o=e.hash_manifest,i=e.hash_blob,n=e.path,h=e.created_at;return[n,"file",i,o,h]})}),(t,e)=>(l(),a("div",z,[e[8]||(e[8]=s("div",{class:"card-header"},[s("h2",{class:"title"},"File Browser"),s("p",null,"List of your uploaded files")],-1)),s("div",L,[e[7]||(e[7]=s("div",{class:"env-badge env-shared"},[s("span",null,"ðŸ“ Shared Environment")],-1)),d.value?(l(),a("div",{key:0,class:k(["result",d.value.type])},[s("div",H,[d.value.type==="completed"?(l(),a("svg",V,[...e[1]||(e[1]=[s("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),a("svg",A,[...e[2]||(e[2]=[s("circle",{cx:"12",cy:"12",r:"10"},null,-1),s("line",{x1:"12",y1:"8",x2:"12",y2:"12"},null,-1),s("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"},null,-1)])]))]),s("div",K,[s("h3",null,u(d.value.title),1),s("p",null,u(d.value.message),1),d.value.jobId?(l(),a("div",J,[s("span",null,"Job ID: "+u(d.value.jobId),1),s("button",{onClick:e[0]||(e[0]=(...o)=>t.checkStatus&&t.checkStatus(...o)),class:"btn-sm"},"Check Status")])):r("",!0)])],2)):r("",!0),s("div",Q,[(l(!0),a(v,null,_(T.value,(o,i)=>(l(),a("div",{key:i,class:"mb-2"},[i!=="/"?(l(),a("div",{key:0,class:"flex items-center gap-2 py-2 cursor-pointer",onClick:n=>w(i)},[e[3]||(e[3]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-blue-600",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),s("span",U,u(i),1),s("span",Y," ("+u(o.length)+" items) ",1)],8,G)):r("",!0),D(s("div",P,[(l(!0),a(v,null,_(o,n=>(l(),a("div",{key:n[0],class:k(["flex items-center gap-2 py-1.5 group",{"pl-4":n[1]==="file"}])},[s("div",ee,[n[1]==="directory"?(l(),a("svg",te,[...e[4]||(e[4]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"},null,-1)])])):(l(),a("svg",se,[...e[5]||(e[5]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])]))]),s("span",{class:k(["text-sm font-mono",{"font-semibold text-blue-800":n[1]==="directory","text-gray-700":n[1]==="file"}])},u(n[0].split("/").pop()||n[0]),3),n[1]==="file"?(l(),a("button",{key:0,onClick:b(h=>Z(n),["stop"]),class:"btn-sm blue opacity-0 group-hover:opacity-100 transition-opacity"}," Download ",8,oe)):r("",!0),n[1]==="file"?(l(),a("button",{key:1,onClick:b(h=>C(n),["stop"]),class:"btn-sm red opacity-0 group-hover:opacity-100 transition-opacity"}," Delete ",8,ne)):r("",!0),n[1]==="file"?(l(),a("button",{key:2,onClick:b(h=>F(n),["stop"]),class:"btn-sm green opacity-0 group-hover:opacity-100 transition-opacity"}," To Workspace ",8,ae)):r("",!0)],2))),128))],512),[[R,x(i)||i==="/"]])]))),128)),c.value.length===0?(l(),a("div",le,[...e[6]||(e[6]=[s("p",null,"No files uploaded yet.",-1)])])):r("",!0)])])]))}});O(ie).mount("#upload-list-app");
